<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>B·∫£ng t√≠nh kh·ªëi g·ªó & gi√° ti·ªÅn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      padding: 16px;
      box-sizing: border-box;
      max-width: 90%;
    }
    h2 {
      font-size: 1.0em;
      margin-bottom: 20px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 12px;
    }
    label {
      flex: 1 0 160px;
      margin-bottom: 4px;
    }
    input {
      flex: 1 0 160px;
      padding: 6px;
      font-size: 1em;
    }
    .result-inline {
      font-weight: bold;
      color: #333;
      flex: 1 0 100%;
      margin-top: 4px;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      width: 99%;
      max-width: 300px;
      margin: 16px 0;
    }
    table {
      width: 99%;
      border-collapse: collapse;
      font-size: 0.9em;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #888;
      padding: 8px 4px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h2>B·∫£ng t√≠nh kh·ªëi g·ªó & gi√° ti·ªÅn</h2>

  <div class="row">
    <label>D√†i (mm):</label>
    <input type="number" id="length" placeholder="250">
  </div>
  <div class="row">
    <label>R·ªông (mm):</label>
    <input type="number" id="width" placeholder="120">
  </div>
  <div class="row">
    <label>Cao (mm):</label>
    <input type="number" id="height" placeholder="20">
  </div>

  <div class="row">
    <label>Gi√° d·ª± ki·∫øn s·∫£n ph·∫©m:</label>
    <input type="text" id="unitPrice" oninput="formatMoneyInput(this)" placeholder="nh·∫≠p ·ªü ƒë√¢y (gi√° d·ª± ki·∫øn s·∫£n ph·∫©m)">
    <span class="result-inline" id="totalPriceOutput"></span>
  </div>

  <div class="row">
    <label>Gi√° d·ª± ki·∫øn 1 kh·ªëi g·ªó:</label>
    <input type="text" id="blockPrice" oninput="formatMoneyInput(this)" placeholder="nh·∫≠p ·ªü ƒë√¢y (gi√° d·ª± ki·∫øn 1 kh·ªëi g·ªó)">
    <span class="result-inline" id="pricePerUnitOutput"></span>
  </div>

  <button onclick="calculate()">T√≠nh</button>

  <div class="results">
    <div class="result-inline" id="volumeOutput"></div>
    <div class="result-inline" id="quantityOutput"></div>
  </div>

  <table id="historyTable">
    <thead>
      <tr>
        <th>D√†i</th><th>R·ªông</th><th>Cao</th><th>S·ªë kh·ªëi</th>
        <th>S·ªë SP</th><th>Gi√°/SP</th><th>Gi√°/Kh·ªëi</th><th>Gi√° 1 SP</th><th>Gi√° / Kh·ªëi g·ªó</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    function formatMoneyInput(input) {
      let raw = input.value.replace(/[^\d]/g, "");
      if (raw === "") {
        input.value = "";
        return;
      }
      input.value = parseInt(raw).toLocaleString("vi-VN");
    }

    function parseMoney(inputValue) {
      return parseInt(inputValue.replace(/[^\d]/g, ""));
    }

    function calculate() {
      const length = parseFloat(document.getElementById("length").value);
      const width = parseFloat(document.getElementById("width").value);
      const height = parseFloat(document.getElementById("height").value);
      const unitPrice = parseMoney(document.getElementById("unitPrice").value);
      const blockPrice = parseMoney(document.getElementById("blockPrice").value);

      const volumeOutput = document.getElementById("volumeOutput");
      const quantityOutput = document.getElementById("quantityOutput");
      const totalPriceOutput = document.getElementById("totalPriceOutput");
      const pricePerUnitOutput = document.getElementById("pricePerUnitOutput");

      if (!length || !width || !height) {
        volumeOutput.innerText = "‚ùå Vui l√≤ng nh·∫≠p ƒë·ªß 3 k√≠ch th∆∞·ªõc!";
        quantityOutput.innerText = "";
        totalPriceOutput.innerText = "";
        pricePerUnitOutput.innerText = "";
        return;
      }

      const volume = (length / 1000) * (width / 1000) * (height / 1000);
      const quantity = volume > 0 ? (1 / volume) : 0;

      volumeOutput.innerText = `üî¢ S·ªë kh·ªëi: ${volume.toFixed(6)} m¬≥`;
      quantityOutput.innerText = `üì¶ S·ªë s·∫£n ph·∫©m: ${quantity.toFixed(2)} s·∫£n ph·∫©m`;

      if (unitPrice) {
        const totalPrice = Math.round(quantity * unitPrice);
        totalPriceOutput.innerText = `üí∞ Gi√° 1 kh·ªëi: ${totalPrice.toLocaleString("vi-VN")} ‚Ç´`;
      } else {
        totalPriceOutput.innerText = "";
      }

      if (blockPrice) {
        const pricePerUnit = Math.round(blockPrice / quantity);
        pricePerUnitOutput.innerText = `üßæ Gi√° 1 s·∫£n ph·∫©m: ${pricePerUnit.toLocaleString("vi-VN")} ‚Ç´`;
      } else {
        pricePerUnitOutput.innerText = "";
      }

      const tableBody = document.querySelector("#historyTable tbody");
      const newRow = document.createElement("tr");

      const displayUnitPrice = unitPrice ? unitPrice.toLocaleString("vi-VN") + " ‚Ç´" : "-";
      const displayBlockPrice = blockPrice ? blockPrice.toLocaleString("vi-VN") + " ‚Ç´" : "-";
      const displayTotalPrice = unitPrice ? Math.round(quantity * unitPrice).toLocaleString("vi-VN") + " ‚Ç´" : "-";
      const displayPricePerUnit = blockPrice ? Math.round(blockPrice / quantity).toLocaleString("vi-VN") + " ‚Ç´" : "-";

      newRow.innerHTML = `
        <td>${length || "-"}</td>
        <td>${width || "-"}</td>
        <td>${height || "-"}</td>
        <td>${volume.toFixed(6)}</td>
        <td>${quantity.toFixed(2)}</td>
        <td>${displayUnitPrice}</td>
        <td>${displayTotalPrice}</td>
        <td>${displayPricePerUnit}</td>
        <td>${displayBlockPrice}</td>
      `;

      tableBody.appendChild(newRow);
    }
  </script>
</body>
</html>
